<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Dashboard Reviewer</title>
  <link rel="stylesheet" href="style.css">
  <link href="https://fonts.googleapis.com/css2?family=VT323&display=swap" rel="stylesheet">
</head>
<body>
   
  <div class="container">
    <h1>📋 Dashboard Reviewer</h1>
    <nav>
      <a href="index.html" onclick="logout()">Logout</a>
    </nav>
    <p id="welcome"></p>
    <div id="essayList"></div>
    <!-- Tambahkan di dalam <div class="container"> -->
    <div id="deadlineInfo" class="timer-bar"></div>
    <div id="certificateSection" style="margin-top: 20px;"></div>

  </div>

  <script src="data.js"></script>
  <script>
    const reviewerNRP = localStorage.getItem("reviewerNRP");
    if (!reviewerNRP) {
      window.location.href = "index.html";
    }

    const assignments = REVIEWER_ASSIGNMENTS[reviewerNRP] || [];
    const reviewer = REVIEWERS.find(r => r.id === reviewerNRP);
    document.getElementById("welcome").textContent = `Halo ${reviewer?.name || reviewerNRP}, berikut tugas Anda:`;

    const essayListDiv = document.getElementById("essayList");

    assignments.forEach(id => {
      const essay = ESSAYS.find(e => e.id === id);
      if (!essay) return;

      const card = document.createElement("div");
      card.className = "card";

      card.innerHTML = `
        <h2>${essay.title}</h2>
        <iframe src="${essay.gdrive}" width="100%" height="300" style="border:1px solid #ccc; border-radius:8px;"></iframe>
        <button onclick="mulaiKoreksi('${essay.id}')">Mulai Koreksi</button>
      `;
      essayListDiv.appendChild(card);
    });

    function mulaiKoreksi(essayId) {
      localStorage.setItem("currentEssayId", essayId);
      window.location.href = "koreksi.html";
    }

    function logout() {
      localStorage.clear();
    }
    // 1. Deadline Timer (1 - 5 Oktober 2025)
function setupDeadline() {
  const deadline = new Date("2025-10-05T23:59:59").getTime();
  const now = new Date().getTime();
  const remaining = deadline - now;

  if (remaining <= 0) {
    document.getElementById("deadlineInfo").innerHTML = `<b style="color:red;">⏰ Deadline koreksi sudah berakhir.</b>`;
    return;
  }

  const days = Math.floor(remaining / (1000 * 60 * 60 * 24));
  const hours = Math.floor((remaining / (1000 * 60 * 60)) % 24);
  const minutes = Math.floor((remaining / (1000 * 60)) % 60);
  const seconds = Math.floor((remaining / 1000) % 60);

  document.getElementById("deadlineInfo").innerHTML = `
    ⏳ Sisa waktu koreksi: ${days} hari ${hours} jam ${minutes} menit ${seconds} detik
  `;
  setTimeout(setupDeadline, 1000);
}
setupDeadline();

// 2. Sertifikat (jika semua sudah dinilai)
function cekSelesaiDanTampilkanSertifikat() {
  const assignments = REVIEWER_ASSIGNMENTS[reviewerNRP] || [];
  const belumDinilai = assignments.filter(id => !getEvaluation(id));
  const container = document.getElementById("certificateSection");

  if (belumDinilai.length === 0 && assignments.length > 0) {
    container.innerHTML = `
      <h3>🎉 Selamat! Anda telah menyelesaikan semua penilaian.</h3>
      <button onclick="window.open('sertifikat.html', '_blank')">🎓 Klaim Sertifikat</button>
    `;
  }
}
cekSelesaiDanTampilkanSertifikat();

  </script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/howler/2.2.3/howler.min.js"></script>
<script>
  const blip = new Howl({ src: ['assets/sfx/select.mp3'], volume: 0.9 });
  document.querySelectorAll("button").forEach(btn => {
    btn.addEventListener("click", () => blip.play());
  });
</script>

</body>
</html>
